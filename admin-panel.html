<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MIUXO | SECURE ADMIN</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --admin-blue: #2563eb; --bg: #020617; }
        body { background: var(--bg); color: white; font-family: sans-serif; padding: 20px; }
        
        /* Login Gate Styles */
        #admin-lock { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 10000; }
        .lock-box { background: rgba(255,255,255,0.05); padding: 40px; border-radius: 20px; border: 1px solid var(--admin-blue); text-align: center; }
        
        /* Dashboard Styles */
        #admin-content { display: none; }
        .card { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; border: 1px solid var(--admin-blue); margin-bottom: 20px; }
        .stats-grid { display: flex; gap: 15px; margin-bottom: 20px; }
        .stat-box { flex: 1; background: #0f172a; padding: 15px; border-radius: 10px; border: 1px solid #22c55e; text-align: center; }
        input { padding: 10px; border-radius: 8px; border: 1px solid var(--admin-blue); background: #000; color: #fff; margin: 5px; }
        .btn { padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; background: var(--admin-blue); color: white; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; border-bottom: 1px solid #333; text-align: left; }
    </style>
</head>
<body>

    <div id="admin-lock">
        <div class="lock-box">
            <h2 style="color: var(--admin-blue);">üõ°Ô∏è MIUXO AUTH</h2>
            <input type="password" id="admin-pass" placeholder="Enter Admin Password">
            <br><br>
            <button class="btn" onclick="checkPass()">ACCESS DASHBOARD</button>
        </div>
    </div>

    <div id="admin-content">
        <h1>üöÄ MIUXO COMMAND CENTER</h1>
        
        <div class="stats-grid">
            <div class="stat-box">
                <small>LAST 24 HOURS</small>
                <h2 id="revenue-24h" style="color: #22c55e;">‚Çπ0</h2>
                <p id="sales-24h" style="font-size: 0.7rem; margin-top: -10px;">0 sales</p>
            </div>
            <div class="stat-box" style="border-color: #fbbf24;">
                <small>ALL-TIME REVENUE</small>
                <h2 id="total-revenue">‚Çπ0</h2>
                <p id="total-sales" style="font-size: 0.7rem; margin-top: -10px;">0 sales</p>
            </div>
        </div>

        <div class="card">
            <h3>‚ûï ACTIONS</h3>
            <input type="text" id="manual-input" placeholder="Code or Phone Number">
            <button class="btn" onclick="addManualCode()">Generate Code</button>
            <button class="btn" style="background: #ef4444;" onclick="banUser()">Ban Phone</button>
        </div>

        <div class="card">
            <h3>üìã TRANSACTION LOGS</h3>
            <table id="data-table">
                <thead><tr><th>Time</th><th>Phone</th><th>UTR</th><th>Code</th><th>Action</th></tr></thead>
                <tbody id="logs"></tbody>
            </table>
        </div>
    </div>

    <script>
        // CONFIGURATION
        const ADMIN_PASSWORD = "MIUXO_BOSS_2025"; // Change this to your desired password!
        const firebaseConfig = { databaseURL: "https://miuxo-a750e-default-rtdb.firebaseio.com/" };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // LOGIN LOGIC
        function checkPass() {
            const pass = document.getElementById('admin-pass').value;
            if(pass === ADMIN_PASSWORD) {
                document.getElementById('admin-lock').style.display = 'none';
                document.getElementById('admin-content').style.display = 'block';
                loadData();
            } else {
                alert("Incorrect Password!");
            }
        }

        // DATABASE LOGIC
        function loadData() {
            database.ref('transactions').on('value', snap => {
                const logs = document.getElementById('logs');
                logs.innerHTML = "";
                const data = snap.val();
                
                let totalCount = 0, count24h = 0;
                const now = new Date().getTime();

                if(data) {
                    Object.keys(data).reverse().forEach(utr => {
                        const item = data[utr];
                        totalCount++;
                        if (now - new Date(item.time).getTime() < 86400000) count24h++;

                        logs.innerHTML += `<tr>
                            <td>${item.time}</td>
                            <td>${item.phone}</td>
                            <td>${utr}</td>
                            <td style="color:#fbbf24;">${item.code}</td>
                            <td><button class="btn" style="background:#ef4444; padding:5px 10px;" onclick="deleteUser('${utr}', '${item.code}')">Del</button></td>
                        </tr>`;
                    });
                }
                document.getElementById('total-revenue').innerText = "‚Çπ" + (totalCount * 50);
                document.getElementById('revenue-24h').innerText = "‚Çπ" + (count24h * 50);
                document.getElementById('total-sales').innerText = totalCount + " sales";
                document.getElementById('sales-24h').innerText = count24h + " sales";
            });
        }

        function addManualCode() { database.ref(document.getElementById('manual-input').value).set("VIP Access"); alert("Code Added!"); }
        function banUser() { database.ref('blacklist/'+document.getElementById('manual-input').value).set({bannedAt: new Date().toLocaleString()}); alert("User Banned!"); }
        function deleteUser(u, c) { if(confirm("Delete?")) { database.ref('transactions/'+u).remove(); database.ref(c).remove(); } }
    </script>
</body>
</html>
